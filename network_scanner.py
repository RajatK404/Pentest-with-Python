'''This scripting tool is a Simple Network Scanner which is useful in identifying the live hosts in a network. '''

# usage = python .\.network_scanner.py 192.192.192.0/24


# Import necessary modules
from scapy.all import srp
from scapy.layers.l2 import ARP, Ether
import sys

# Retrieve the target network from command-line arguments
target_network = sys.argv[1]

# List to store the online clients
online_clients = []

# Create an Ether frame to broadcast to all devices on the network
ether = Ether(dst='ff:ff:ff:ff:ff:ff')

# Create an ARP packet to send to the target network
arp = ARP(pdst=target_network)

# Combine the Ether and ARP packets to create a complete probe
probe = ether / arp

# Send the probe and capture the results
result = srp(probe, timeout=3, verbose=0)

# Extract the answered packets
answered = result[0]

# Iterate through the answered packets and extract IP and MAC addresses
for sent, received in answered:
    online_clients.append({'ip': received.psrc, 'mac': received.hwsrc})

# Display the available hosts
print("[+] Available Hosts: ")
print("IP" + " " * 22 + "MAC")

# Print the IP and MAC addresses of the online clients
for client in online_clients:
    print(f"{client['ip']}\t\t{client['mac']}")