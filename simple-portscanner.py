'''It is a Simple Port Scanner which scans the open ports one by one(sequentially). 
Usage is:--> pyhton/python3 portscanner.py TARGET  START PORT  END PORT'''


import socket, sys, time

# Usage information for the port scanner
usage = "python/python3 portscanner.py TARGET START_PORT END_PORT"

# Display the title of the port scanner
print("*" * 20)
print("Simple Port Scanner")
print("*" * 20)

# Retrieve the target, start port, and end port from command-line arguments
target = sys.argv[1]
target = socket.gethostbyname(target)
start_port = int(sys.argv[2])
end_port = int(sys.argv[3])

# Check if the target, start port, or end port are missing in the command-line arguments
if not target or not str(start_port) or not str(end_port):
    print(usage)
    exit()

# Record the start time of the port scanning process
start_time = time.time()

# Iterate through the range of ports to scan
for port in range(start_port, end_port + 1):
    # Create a socket and set a timeout for the connection attempt
    soc = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    soc.settimeout(1)
    # Attempt to connect to the target and port
    connect = soc.connect_ex((target, port))
    # Check if the connection was successful
    if not connect:
        print(f"[+] Port {port} is open.")

# Record the end time of the port scanning process
end_time = time.time()

# Display the total time taken for the port scanning process
print(f"Time taken: {int(end_time - start_time)} sec")